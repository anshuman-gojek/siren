apiVersion: v2
type: template
name: cpu2
body:
  - alert: CPUHighWarning2
    expr: avg by (host) (cpu_usage_user{cpu="cpu-total"}) > [[.warning]]
    for: "[[.for]]"
    labels:
      severity: WARNING
    annotations:
      dashboard: https://radar.golabs.io/d/jL3y8pLZk/system-metrics?orgId=1
      description: CPU has been above [[.warning]] for last [[.for]] {{ $labels.host }}
  - alert: CPUHighCritical2
    expr: avg by (host) (cpu_usage_user{cpu="cpu-total"}) > [[.critical]]
    for: "[[.for]]"
    labels:
      severity: CRITICAL
    annotations:
      dashboard: https://radar.golabs.io/d/jL3y8pLZk/system-metrics?orgId=1
      description: CPU has been above [[.critical]] for last [[.for]] {{ $labels.host }}
variables:
  - name: for
    type: string
    default: 10m
    description: For eg 5m, 2h; Golang duration format
  - name: warning
    type: int
    default: 10
  - name: critical
    type: int
    default: 20
tags:
  - systems
